"use strict";(self.webpackChunkrspress_doc_template=self.webpackChunkrspress_doc_template||[]).push([["3162"],{380:function(e,r,n){n.r(r),n.d(r,{default:function(){return h}});var s=n(5893),i=n(65);function t(e){let r=Object.assign({h1:"h1",a:"a",h2:"h2",h3:"h3",p:"p",pre:"pre",code:"code",em:"em",h4:"h4",ul:"ul",li:"li"},(0,i.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.h1,{id:"hive",children:["Hive",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#hive",children:"#"})]}),"\n",(0,s.jsxs)(r.h2,{id:"install-and-config",children:["install and config",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#install-and-config",children:"#"})]}),"\n",(0,s.jsxs)(r.h3,{id:"files",children:["files",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#files",children:"#"})]}),"\n",(0,s.jsx)(r.p,{children:"copy hive files to /opt/apps/hive"}),"\n",(0,s.jsxs)(r.h3,{id:"config-of-hive-envsh",children:["config of hive-env.sh",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#config-of-hive-envsh",children:"#"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"cp hive/conf/hive-env.sh.template hive/conf/hive-env.sh\r\n\r\nvim hive/conf/hive-env.sh\r\n\r\nexport HADOOP_HOME=/opt/apps/hadoop\r\nexport HIVE_CONF_DIR=/opt/apps/hive/conf\r\nexport HIVE_AUX_JARS_PATH=/opt/apps/hive/lib\n"})}),"\n",(0,s.jsxs)(r.h3,{id:"config-of-hive-sitesh",children:["config of hive-site.sh",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#config-of-hive-sitesh",children:"#"})]}),"\n",(0,s.jsxs)(r.p,{children:["add file ",(0,s.jsx)(r.code,{children:"vim hive/conf/hive-site.xml"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-xml",children:"<configuration>\r\n\x3c!-- 存储元数据mysql相关配置 --\x3e\r\n<property>\r\n<name>javax.jdo.option.ConnectionURL</name>\r\n<value>jdbc:mysql://10.230.168.111:3306/metastore?createDatabaseIfNotExist=true&amp;useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-8</value>\r\n</property>\r\n<property>\r\n<name>javax.jdo.option.ConnectionDriverName</name>\r\n<value>com.mysql.cj.jdbc.Driver</value>\r\n</property>\r\n<property>\r\n<name>javax.jdo.option.ConnectionUserName</name>\r\n<value>mysql_user</value>\r\n</property>\r\n<property>\r\n<name>javax.jdo.option.ConnectionPassword</name>\r\n<value>mysql_pass</value>\r\n</property>\r\n\x3c!-- H2S运行绑定host --\x3e\r\n<property>\r\n<name>hive.server2.thrift.bind.host</name>\r\n<value>nn.rm</value>\r\n</property>\r\n\x3c!-- 远程模式部署metastore metastore地址 --\x3e\r\n<property>\r\n<name>hive.metastore.uris</name>\r\n<value>thrift://nn.rm:9083</value>\r\n</property>\r\n\x3c!-- 关闭元数据存储授权 --\x3e\r\n<property>\r\n<name>hive.metastore.event.db.notification.api.auth</name>\r\n<value>false</value>\r\n</property>\r\n<property>\r\n  <name>hive.server2.thrift.bind.host</name>\r\n  <value>nn.rm</value>\r\n</property>\r\n</configuration>\n"})}),"\n",(0,s.jsxs)(r.h3,{id:"upload-mysql-driver",children:["upload mysql driver",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#upload-mysql-driver",children:"#"})]}),"\n",(0,s.jsxs)(r.p,{children:["upload mysql driver ",(0,s.jsx)(r.em,{children:"mysql-connector-java-8.0.30.jar"})," to ",(0,s.jsx)(r.code,{children:"hive/lib/mysql-connector-java-8.0.30.jar"})]}),"\n",(0,s.jsxs)(r.h2,{id:"init-metastore",children:["init metastore",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#init-metastore",children:"#"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"cd /opt/apps/hive\r\nbin/schematool -initSchema -dbType mysql -verbose\n"})}),"\n",(0,s.jsxs)(r.p,{children:["the log located at ",(0,s.jsx)(r.code,{children:"cat /tmp/$USER/hive.log"})]}),"\n",(0,s.jsxs)(r.h2,{id:"start-services",children:["start services",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#start-services",children:"#"})]}),"\n",(0,s.jsxs)(r.h3,{id:"start-metastore-svc",children:["start metastore svc",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#start-metastore-svc",children:"#"})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.code,{children:"nohup /opt/apps/hive/bin/hive --service metastore > metastore.log 2>&1 &"})}),"\n",(0,s.jsxs)(r.p,{children:["check svc by ",(0,s.jsx)(r.code,{children:"jps"})," or  ",(0,s.jsx)(r.code,{children:"ss -anp | grep 9083"})]}),"\n",(0,s.jsxs)(r.h3,{id:"start-hiveserver2-svc",children:["start hiveserver2 svc",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#start-hiveserver2-svc",children:"#"})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.code,{children:"nohup /opt/apps/hive/bin/hive --service hiveserver2 > hiveserver2.log 2>&1 &"})}),"\n",(0,s.jsxs)(r.p,{children:["check svc by ",(0,s.jsx)(r.code,{children:"jps"})," or  ",(0,s.jsx)(r.code,{children:"ss -anp | grep 10000"})]}),"\n",(0,s.jsxs)(r.h4,{id:"errors-in-tmpuserhivelog",children:["errors in ",(0,s.jsx)(r.code,{children:"/tmp/$USER/hive.log"}),(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#errors-in-tmpuserhivelog",children:"#"})]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["error ",(0,s.jsx)(r.code,{children:"Can't function without a valid hostname! "})," fix it by ",(0,s.jsx)(r.code,{children:"sudo hostnamectl set-hostname nn.rm"})]}),"\n"]}),"\n",(0,s.jsxs)(r.h2,{id:"connect-to-hive",children:["connect to hive",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#connect-to-hive",children:"#"})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.code,{children:"/opt/apps/hive/bin/beeline -u jdbc:hive2://nn.rm:10000 --verbose=true"})})]})}function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:r}=Object.assign({},(0,i.ah)(),e.components);return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}let h=a;a.__RSPRESS_PAGE_META={},a.__RSPRESS_PAGE_META["notes%2F06-Big%20Data%2Fhive.md"]={toc:[{text:"install and config",id:"install-and-config",depth:2},{text:"files",id:"files",depth:3},{text:"config of hive-env.sh",id:"config-of-hive-envsh",depth:3},{text:"config of hive-site.sh",id:"config-of-hive-sitesh",depth:3},{text:"upload mysql driver",id:"upload-mysql-driver",depth:3},{text:"init metastore",id:"init-metastore",depth:2},{text:"start services",id:"start-services",depth:2},{text:"start metastore svc",id:"start-metastore-svc",depth:3},{text:"start hiveserver2 svc",id:"start-hiveserver2-svc",depth:3},{text:"errors in `/tmp/$USER/hive.log`",id:"errors-in-tmpuserhivelog",depth:4},{text:"connect to hive",id:"connect-to-hive",depth:2}],title:"Hive",frontmatter:{}}}}]);