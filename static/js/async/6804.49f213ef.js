"use strict";(self.webpackChunkrspress_doc_template=self.webpackChunkrspress_doc_template||[]).push([["6804"],{897:function(e,s,r){r.r(s),r.d(s,{default:function(){return c}});var n=r(5893),i=r(65);function t(e){let s=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",ul:"ul",li:"li",code:"code",pre:"pre",h3:"h3"},(0,i.ah)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.h1,{id:"hub-hardening",children:["Hub Hardening",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#hub-hardening",children:"#"})]}),"\n",(0,n.jsxs)(s.p,{children:["These hardening steps are in order to satisfy the requiment of MTR's server security, more detailed requirments please refer to the ",(0,n.jsx)(s.a,{href:"/",children:"Unix Server Security Hardening Guide.pdf"})]}),"\n",(0,n.jsxs)(s.h2,{id:"2-account-policy",children:["2. Account Policy",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#2-account-policy",children:"#"})]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["edit file ",(0,n.jsx)(s.code,{children:"/etc/ssh/sshd_config"}),", to make sure following configuration."]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"PermitRootLogin no\r\nPasswordAuthentication no\r\nChallengeResponseAuthentication no\r\nKerberosAuthentication no\r\nGSSAPIAuthentication no\r\nX11Forwarding no\r\nPrintMotd no\n"})}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"sudo systemctl restart sshd"}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.h3,{id:"21-privileged-accounts",children:["2.1 Privileged Accounts",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#21-privileged-accounts",children:"#"})]}),"\n",(0,n.jsx)(s.p,{children:"Requirments:\r\nAutomatic account lockout after consecutive login failures is not implemented because it can be used as a form of denial of service. It may lock out the entire server if the root account is locked."}),"\n",(0,n.jsx)(s.p,{children:"Action:\r\nRoot account was"}),"\n",(0,n.jsxs)(s.h3,{id:"221-administrative-accounts",children:["2.2.1 Administrative Accounts",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#221-administrative-accounts",children:"#"})]}),"\n",(0,n.jsx)(s.p,{children:"We use ssh key to login, no password managment."}),"\n",(0,n.jsxs)(s.h3,{id:"222-system-accounts",children:["2.2.2 System Accounts",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#222-system-accounts",children:"#"})]}),"\n",(0,n.jsx)(s.p,{children:"sudo usermod -L daemon\r\nsudo usermod -L bin\r\nsudo usermod -L sys\r\nsudo usermod -L uucp\r\nsudo usermod -L lp\r\nsudo usermod -L nobody\r\nsudo usermod -L games\r\nsudo usermod -L news\r\nsudo usermod -L www-data\r\nsudo usermod -L mail"}),"\n",(0,n.jsxs)(s.h2,{id:"23-system-account-management-improvement",children:["2.3 System Account Management Improvement",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#23-system-account-management-improvement",children:"#"})]}),"\n",(0,n.jsxs)(s.p,{children:["Not apply, we have "," and hub account exist."]}),"\n",(0,n.jsxs)(s.h2,{id:"24-privileged-account-controls",children:["2.4 Privileged Account Controls",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#24-privileged-account-controls",children:"#"})]}),"\n",(0,n.jsx)(s.p,{children:"Not apply."}),"\n",(0,n.jsxs)(s.h2,{id:"3-password-policy",children:["3 Password Policy",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#3-password-policy",children:"#"})]}),"\n",(0,n.jsx)(s.p,{children:"Not Apply, We use ssh key to login, no password managment."}),"\n",(0,n.jsxs)(s.h2,{id:"4-system-logging-policy",children:["4 System Logging Policy",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#4-system-logging-policy",children:"#"})]}),"\n",(0,n.jsx)(s.p,{children:"if the client do not need to centralize the log, skip this step."}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Edit ",(0,n.jsx)(s.code,{children:"/etc/rsyslog.conf"})," file"]}),"\n",(0,n.jsxs)(s.li,{children:["Add ",(0,n.jsx)(s.code,{children:"*.info @syslog.corp.mtrc.com"}),"  # different client may use different syslog server, make sure change it."]}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.code,{children:"sudo systemctl restart rsyslog.service"})}),"\n"]}),"\n",(0,n.jsxs)(s.h2,{id:"5-clock-synchronization",children:["5 Clock Synchronization",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#5-clock-synchronization",children:"#"})]}),"\n",(0,n.jsx)(s.p,{children:"If the client don't have ntp server, skip this step or just install ntp servie is fine."}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.code,{children:"sudo apt-get install ntp"})}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"sudo vim /etc/ntp.conf"}),", remark all pool and restrict start lines, add following lines to the end of file. Please take care of the server for different clients."]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:" server ntp1.corp.mtrc.com prefer \r\n server ntp2.corp.mtrc.com \r\n server ntp3.corp.mtrc.com \r\n server ntp4.corp.mtrc.com \r\n restrict default ignore\n"})}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.code,{children:"sudo systemctl restart ntp"})}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.h2,{id:"6-minimize-inetd-network-services",children:["6 Minimize inetd network services",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#6-minimize-inetd-network-services",children:"#"})]}),"\n",(0,n.jsx)(s.p,{children:"We don't have the listed servcies installed."}),"\n",(0,n.jsxs)(s.h2,{id:"7-disable-un-necessary-services",children:["7 Disable un-necessary services",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#7-disable-un-necessary-services",children:"#"})]}),"\n",(0,n.jsxs)(s.p,{children:["We don't have the listed servcies installed.\r\nIf there is servie un-necessary. run ",(0,n.jsx)(s.code,{children:"systemctl disable <service name>"})," to disable it."]}),"\n",(0,n.jsxs)(s.h2,{id:"8-restrict-file-directory-permissions-to-authorized-users",children:["8 Restrict File/ Directory Permissions to Authorized Users",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#8-restrict-file-directory-permissions-to-authorized-users",children:"#"})]}),"\n",(0,n.jsx)(s.p,{children:"Don't have this kind of files."}),"\n",(0,n.jsxs)(s.h2,{id:"9-restrict-system-access-authentication-and-authorization",children:["9 Restrict System Access, Authentication, and Authorization",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#9-restrict-system-access-authentication-and-authorization",children:"#"})]}),"\n",(0,n.jsxs)(s.h3,{id:"91-enable-hidden-passwords",children:["9.1 Enable Hidden Passwords",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#91-enable-hidden-passwords",children:"#"})]}),"\n",(0,n.jsx)(s.p,{children:"It use shadow passwords by default, and we do't use password."}),"\n",(0,n.jsxs)(s.h3,{id:"92-restrict-atcron-to-authorized-users",children:["9.2 Restrict at/cron to authorized users",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#92-restrict-atcron-to-authorized-users",children:"#"})]}),"\n",(0,n.jsx)(s.p,{children:"sudo vim /etc/cron.d/cron.allow\r\nAdd one user per line. If there are no users in /etc/cron.d/cron.allow, only root user will be allowed to use crontab.\r\nIt's an empty file."}),"\n",(0,n.jsxs)(s.h3,{id:"93-restrict-crontab-file-permissions",children:["9.3 Restrict crontab file permissions",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#93-restrict-crontab-file-permissions",children:"#"})]}),"\n",(0,n.jsx)(s.p,{children:"We don't have crotnab file"}),"\n",(0,n.jsxs)(s.h3,{id:"94-set-retry-limit-for-account-lockout",children:["9.4 Set retry limit for account lockout",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#94-set-retry-limit-for-account-lockout",children:"#"})]}),"\n",(0,n.jsxs)(s.p,{children:["It seems this is not suitable for "," account."]}),"\n",(0,n.jsxs)(s.h3,{id:"95-session-timeout-policy",children:["9.5 Session Timeout Policy",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#95-session-timeout-policy",children:"#"})]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["edit ",(0,n.jsx)(s.code,{children:"/etc/profile"})]}),"\n",(0,n.jsxs)(s.li,{children:["Add ",(0,n.jsx)(s.code,{children:"export TMOUT=1800"})]}),"\n"]}),"\n",(0,n.jsxs)(s.h2,{id:"10-secure-user-accounts-and-environment",children:["10 Secure User Accounts and Environment",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#10-secure-user-accounts-and-environment",children:"#"})]}),"\n",(0,n.jsxs)(s.h3,{id:"101-verify-that-there-are-no-accounts-with-empty-password-field",children:["10.1 Verify that there are no accounts with empty password field",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#101-verify-that-there-are-no-accounts-with-empty-password-field",children:"#"})]}),"\n",(0,n.jsx)(s.p,{children:"We use ssh key to login, no password."}),"\n",(0,n.jsxs)(s.h3,{id:"102-secure-user-home-directories",children:["10.2 Secure user home directories",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#102-secure-user-home-directories",children:"#"})]}),"\n",(0,n.jsxs)(s.p,{children:["sudo chmod 750 autotunnel\r\nsudo chmod 750 ","\r\nsudo chmod 750 hub"]}),"\n",(0,n.jsxs)(s.h3,{id:"103-no-user-dot-files-should-be-groupworld-writable",children:["10.3 No user dot-files should be group/world writable",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#103-no-user-dot-files-should-be-groupworld-writable",children:"#"})]}),"\n",(0,n.jsx)(s.p,{children:"sudo chmod g-w .*\r\nsudo chmod o-w .*"}),"\n",(0,n.jsxs)(s.h3,{id:"104-set-default-umask-for-users",children:["10.4 Set default umask for users",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#104-set-default-umask-for-users",children:"#"})]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["edit ",(0,n.jsx)(s.code,{children:"/etc/profile"})]}),"\n",(0,n.jsxs)(s.li,{children:["Add ",(0,n.jsx)(s.code,{children:"umask 002"}),", or maybe 027. MTR requested 002."]}),"\n"]}),"\n",(0,n.jsxs)(s.h3,{id:"105-set-mesg-n-as-default-for-all-users",children:['10.5 Set "mesg n" as default for all users',(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#105-set-mesg-n-as-default-for-all-users",children:"#"})]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["edit ",(0,n.jsx)(s.code,{children:"/etc/profile"})]}),"\n",(0,n.jsxs)(s.li,{children:["Add ",(0,n.jsx)(s.code,{children:"mesg n"})]}),"\n"]}),"\n",(0,n.jsxs)(s.h2,{id:"11-warning-banners",children:["11 Warning Banners",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#11-warning-banners",children:"#"})]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.code,{children:"sudo vim /etc/pam.d/sshd"})}),"\n",(0,n.jsx)(s.li,{children:"remark this line. # session    optional     pam_motd.so  motd=/run/motd.dynamic"}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.code,{children:"sudo systemctl stop motd-news.timer"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.code,{children:"sudo systemctl disable motd-news.timer"})}),"\n"]}),"\n",(0,n.jsxs)(s.h2,{id:"12-snmp-setting",children:["12 SNMP Setting",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#12-snmp-setting",children:"#"})]}),"\n",(0,n.jsx)(s.p,{children:"we don't have SNMP installed."}),"\n",(0,n.jsxs)(s.h2,{id:"13-security-patches",children:["13 Security Patches",(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#13-security-patches",children:"#"})]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"sudo apt-get update"})," to install all updates."]})]})}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,i.ah)(),e.components);return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(t,{...e})}):t(e)}let c=d;d.__RSPRESS_PAGE_META={},d.__RSPRESS_PAGE_META["notes%2F01-Cloud%20Computing%2FLinux%2Fhub%20hardening.md"]={toc:[{text:"2. Account Policy",id:"2-account-policy",depth:2},{text:"2.1 Privileged Accounts",id:"21-privileged-accounts",depth:3},{text:"2.2.1 Administrative Accounts",id:"221-administrative-accounts",depth:3},{text:"2.2.2 System Accounts",id:"222-system-accounts",depth:3},{text:"2.3 System Account Management Improvement",id:"23-system-account-management-improvement",depth:2},{text:"2.4 Privileged Account Controls",id:"24-privileged-account-controls",depth:2},{text:"3 Password Policy",id:"3-password-policy",depth:2},{text:"4 System Logging Policy",id:"4-system-logging-policy",depth:2},{text:"5 Clock Synchronization",id:"5-clock-synchronization",depth:2},{text:"6 Minimize inetd network services",id:"6-minimize-inetd-network-services",depth:2},{text:"7 Disable un-necessary services",id:"7-disable-un-necessary-services",depth:2},{text:"8 Restrict File/ Directory Permissions to Authorized Users",id:"8-restrict-file-directory-permissions-to-authorized-users",depth:2},{text:"9 Restrict System Access, Authentication, and Authorization",id:"9-restrict-system-access-authentication-and-authorization",depth:2},{text:"9.1 Enable Hidden Passwords",id:"91-enable-hidden-passwords",depth:3},{text:"9.2 Restrict at/cron to authorized users",id:"92-restrict-atcron-to-authorized-users",depth:3},{text:"9.3 Restrict crontab file permissions",id:"93-restrict-crontab-file-permissions",depth:3},{text:"9.4 Set retry limit for account lockout",id:"94-set-retry-limit-for-account-lockout",depth:3},{text:"9.5 Session Timeout Policy",id:"95-session-timeout-policy",depth:3},{text:"10 Secure User Accounts and Environment",id:"10-secure-user-accounts-and-environment",depth:2},{text:"10.1 Verify that there are no accounts with empty password field",id:"101-verify-that-there-are-no-accounts-with-empty-password-field",depth:3},{text:"10.2 Secure user home directories",id:"102-secure-user-home-directories",depth:3},{text:"10.3 No user dot-files should be group/world writable",id:"103-no-user-dot-files-should-be-groupworld-writable",depth:3},{text:"10.4 Set default umask for users",id:"104-set-default-umask-for-users",depth:3},{text:'10.5 Set "mesg n" as default for all users',id:"105-set-mesg-n-as-default-for-all-users",depth:3},{text:"11 Warning Banners",id:"11-warning-banners",depth:2},{text:"12 SNMP Setting",id:"12-snmp-setting",depth:2},{text:"13 Security Patches",id:"13-security-patches",depth:2}],title:"Hub Hardening",frontmatter:{}}}}]);