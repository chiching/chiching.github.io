"use strict";(self.webpackChunkrspress_doc_template=self.webpackChunkrspress_doc_template||[]).push([["3043"],{5512:function(e,n,i){i.r(n),i.d(n,{default:()=>l});var r=i("5893"),s=i("65");let d=i.p+"static/image/1700386997735.22c45cce.png";function t(e){let n=Object.assign({h1:"h1",a:"a",h2:"h2",h3:"h3",ul:"ul",li:"li",code:"code",blockquote:"blockquote",pre:"pre",p:"p",img:"img"},(0,s.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h1,{id:"pve",children:["PVE",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#pve",children:"#"})]}),"\n",(0,r.jsxs)(n.h2,{id:"网卡直通",children:["网卡直通",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#网卡直通",children:"#"})]}),"\n",(0,r.jsxs)(n.h3,{id:"打开直通",children:["打开直通",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#打开直通",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["编辑 ",(0,r.jsx)(n.code,{children:"vim /etc/default/grub"}),"。"]}),"\n",(0,r.jsx)(n.li,{children:"注释并添加"}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'#GRUB_CMDLINE_LINUX_DEFAULT="quiet"\nGRUB_CMDLINE_LINUX_DEFAULT="quiet intel_iommu=on"\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["更新配置 ",(0,r.jsx)(n.code,{children:"update-grub"})]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"安装模块",children:["安装模块",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#安装模块",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["编辑 ",(0,r.jsx)(n.code,{children:"vim /etc/modules"})]}),"\n",(0,r.jsx)(n.li,{children:"添加"}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"vfio\nvfio_iommu_type1\nvfio_pci\nvfio_virqfd\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["更新配置 ",(0,r.jsx)(n.code,{children:"update-initramfs -u -k all"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"然后重启PVE节点"}),"\n",(0,r.jsxs)(n.h2,{id:"扩容",children:["扩容",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#扩容",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"dd if=/dev/zero bs=1G count=2 >> openwrt.img"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"parted openwrt.img\n\nprint\nresizepart 2 100%\n\n\n"})}),"\n",(0,r.jsxs)(n.h2,{id:"import-disk",children:["import disk",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#import-disk",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"qm disk import 100 /var/lib/vz/template/iso/openwrt.img local-lvm"})}),"\n",(0,r.jsxs)(n.h2,{id:"openwrt-config",children:["openwrt config",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#openwrt-config",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"vim /etc/config/network"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)("img",{src:d,alt:"1700386997735"})}),"\n",(0,r.jsx)(n.p,{children:"service network restart"}),"\n",(0,r.jsxs)(n.p,{children:["The installed version of package kernel is not compatible, require 5.15.137-1-1 while 5.15.137-1-47964456… is installed.\n",(0,r.jsx)(n.a,{href:"https://hamy.io/post/0015/how-to-compile-openwrt-and-still-use-the-official-repository/",target:"_blank",rel:"noopener noreferrer",children:"https://hamy.io/post/0015/how-to-compile-openwrt-and-still-use-the-official-repository/"})]})]})}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,s.ah)(),e.components);return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}let l=c;c.__RSPRESS_PAGE_META={},c.__RSPRESS_PAGE_META["notes%2F01-Cloud%20Computing%2FLinux%2Fpve.md"]={toc:[{text:"网卡直通",id:"网卡直通",depth:2},{text:"打开直通",id:"打开直通",depth:3},{text:"安装模块",id:"安装模块",depth:3},{text:"扩容",id:"扩容",depth:2},{text:"import disk",id:"import-disk",depth:2},{text:"openwrt config",id:"openwrt-config",depth:2}],title:"PVE",frontmatter:{}}}}]);