"use strict";(self.webpackChunkrspress_doc_template=self.webpackChunkrspress_doc_template||[]).push([["7666"],{3143:function(e,r,d){d.r(r),d.d(r,{default:function(){return i}});var n=d(5893),c=d(65);function a(e){let r=Object.assign({h1:"h1",a:"a",h2:"h2",pre:"pre",code:"code",p:"p",h3:"h3",ol:"ol",li:"li"},(0,c.ah)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.h1,{id:"lxc",children:["LXC",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#lxc",children:"#"})]}),"\n",(0,n.jsxs)(r.h2,{id:"更换源",children:["更换源",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#更换源",children:"#"})]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"cp /usr/share/perl5/PVE/APLInfo.pm /usr/share/perl5/PVE/APLInfo.pm_back\r\nsed -i 's|http://download.proxmox.com|https://mirrors.tuna.tsinghua.edu.cn/proxmox|g' /usr/share/perl5/PVE/APLInfo.pm\n"})}),"\n",(0,n.jsxs)(r.h2,{id:"特权容器",children:["特权容器",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#特权容器",children:"#"})]}),"\n",(0,n.jsx)(r.p,{children:"无特殊情况，首选特权容器。特权容器外挂pve的目录更方便，而且特权容器也是支持docker的。nano  /etc/pve/lxc/容器id.conf 添加下面几行"}),"\n",(0,n.jsx)(r.p,{children:"lxc.apparmor.profile: unconfined\r\nlxc.cgroup.devices.allow: a\r\nlxc.cap.drop:"}),"\n",(0,n.jsxs)(r.h2,{id:"安装docker",children:["安装docker",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#安装docker",children:"#"})]}),"\n",(0,n.jsx)(r.p,{children:"sed -i 's/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g' /etc/apk/repositories"}),"\n",(0,n.jsxs)(r.h3,{id:"安装时区设置",children:["安装时区设置",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#安装时区设置",children:"#"})]}),"\n",(0,n.jsx)(r.p,{children:'apk add tzdata\r\ncp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\r\necho "Asia/Shanghai" > /etc/timezone'}),"\n",(0,n.jsxs)(r.h3,{id:"卸载时区",children:["卸载时区",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#卸载时区",children:"#"})]}),"\n",(0,n.jsx)(r.p,{children:"apk del tzdata\r\nrm -rf /var/cache/apk/*"}),"\n",(0,n.jsxs)(r.h3,{id:"安装docker-1",children:["安装docker",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#安装docker-1",children:"#"})]}),"\n",(0,n.jsx)(r.p,{children:"apk add docker #nano\r\nrm -rf /var/cache/apk/*"}),"\n",(0,n.jsxs)(r.h3,{id:"开机启动启动docker",children:["开机启动启动docker",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#开机启动启动docker",children:"#"})]}),"\n",(0,n.jsx)(r.p,{children:"rc-update add docker boot"}),"\n",(0,n.jsxs)(r.h3,{id:"手动启动docker",children:["手动启动docker",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#手动启动docker",children:"#"})]}),"\n",(0,n.jsx)(r.p,{children:"service docker start"}),"\n",(0,n.jsxs)(r.h3,{id:"查看docker版本",children:["查看docker版本",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#查看docker版本",children:"#"})]}),"\n",(0,n.jsx)(r.p,{children:"docker version"}),"\n",(0,n.jsxs)(r.h2,{id:"直通显卡",children:["直通显卡",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#直通显卡",children:"#"})]}),"\n",(0,n.jsx)(r.p,{children:"vim /etc/pve/lxc/102.conf"}),"\n",(0,n.jsx)(r.p,{children:"需要添加以下内容"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-dsconfig",children:"lxc.apparmor.profile: unconfined\r\nlxc.cgroup.devices.allow: a\r\nlxc.cap.drop:\r\nlxc.cgroup2.devices.allow: c 226:0 rwm\r\nlxc.cgroup2.devices.allow: c 226:128 rwm\r\nlxc.mount.entry: /dev/dri/card0 dev/dri/card0 none bind,optional,create=file\r\nlxc.mount.entry: /dev/dri/renderD128 dev/dri/renderD128 none bind,optional,create=file\n"})}),"\n",(0,n.jsxs)(r.h2,{id:"引用",children:["引用",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#引用",children:"#"})]}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsxs)(r.li,{children:["容器 ",(0,n.jsx)(r.a,{href:"https://dev.leiyanhui.com/pve/docker-mini/",target:"_blank",rel:"noopener noreferrer",children:"https://dev.leiyanhui.com/pve/docker-mini/"})]}),"\n",(0,n.jsxs)(r.li,{children:["换源 ",(0,n.jsx)(r.a,{href:"https://mirrors.tuna.tsinghua.edu.cn/help/proxmox/",target:"_blank",rel:"noopener noreferrer",children:"https://mirrors.tuna.tsinghua.edu.cn/help/proxmox/"})]}),"\n",(0,n.jsxs)(r.li,{children:["扩容 ",(0,n.jsx)(r.a,{href:"https://post.smzdm.com/p/ad9dngwx/",target:"_blank",rel:"noopener noreferrer",children:"https://post.smzdm.com/p/ad9dngwx/"})]}),"\n",(0,n.jsxs)(r.li,{children:["直通显卡 ",(0,n.jsx)(r.a,{href:"https://blog.hellowood.dev/posts/%E5%9C%A8pve%E7%9A%84lxc%E5%AE%B9%E5%99%A8%E4%B8%AD%E7%9B%B4%E9%80%9A%E6%A0%B8%E5%BF%83%E6%98%BE%E5%8D%A1/",target:"_blank",rel:"noopener noreferrer",children:"https://blog.hellowood.dev/posts/%E5%9C%A8pve%E7%9A%84lxc%E5%AE%B9%E5%99%A8%E4%B8%AD%E7%9B%B4%E9%80%9A%E6%A0%B8%E5%BF%83%E6%98%BE%E5%8D%A1/"})]}),"\n"]})]})}function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:r}=Object.assign({},(0,c.ah)(),e.components);return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}let i=h;h.__RSPRESS_PAGE_META={},h.__RSPRESS_PAGE_META["notes%2F01-Cloud%20Computing%2FLinux%2Flxc.md"]={toc:[{text:"更换源",id:"更换源",depth:2},{text:"特权容器",id:"特权容器",depth:2},{text:"安装docker",id:"安装docker",depth:2},{text:"安装时区设置",id:"安装时区设置",depth:3},{text:"卸载时区",id:"卸载时区",depth:3},{text:"安装docker",id:"安装docker-1",depth:3},{text:"开机启动启动docker",id:"开机启动启动docker",depth:3},{text:"手动启动docker",id:"手动启动docker",depth:3},{text:"查看docker版本",id:"查看docker版本",depth:3},{text:"直通显卡",id:"直通显卡",depth:2},{text:"引用",id:"引用",depth:2}],title:"LXC",frontmatter:{}}}}]);